<!DOCTYPE html>
<html lang="fr" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="utf-8">
    <title>Design4Green</title>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>
  <header>
    <div class=header-bar>
      <h1>
        Design4Green Hackaton 2018
      </h1>
    </div>
  </header>
{% set category = "" %}
{% set subcategory = "" %}
<div class='content'>
    <div class="introduction">
      <p>
        With the support of ADEME, the Ministry of Ecology, Energy and the Sea and the Ministry of Economy and Finance,
        the association AGIT (Alliance for Green IT) and the eco-organizations of the recycling network of Waste
        Electrical and Electronic Equipment (WEEE) organize a survey to assess the deposits of computer and office
        equipment present in companies and more generally on the maturity of companies in France in the use of
        eco-responsible digital services.  The duration of the questionnaire is estimated at 15 minutes if you are able
        to answer questions directly.  You can return at any time on the questionnaire, answer in several times, your
        previous answers are recorded. In case of modification, only the last answer will be taken into account.  You
        can submit this questionnaire to several people in your organization. All you have to do is simply share the
        link to the questionnaire.
      </p>
    </div>
<form name='questionnaire'>
    {% for question in questions %}
        {% if question.category != category %}
            {% set category = question.category %}
            {% include "category.html.twig" with {"category": question.category} %}
        {% endif %}
        {% if subcategory and subcategory != question.subcategory %}
            {% set subcategory = '' %}
            </tbody></table></div></div></div> {# used to close "question_prelude.html.twig" opened in earlier iteration #}
        {% endif %}
        {% if question.subcategory %}
            {% if question.subcategory != subcategory %}
                {% set subcategory = question.subcategory %}
                {% include "question_prelude.html.twig" %}
                {% if question.type == 'choice' %}
                    <table>
                        <thead>
                        <tr>
                            <th></th>
                            {% for label, textbox in question.choices %}
                                <th>{{ label }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                {% endif %}
            {% else %}
                {% if question.type == 'choice' %}
                    {% set type = "radio" %}
                    {% if question.multiple %}
                        {% set type = "checkbox" %}
                    {% endif %}
                    <tr>
                        <td>{{ question.content }}</td>
                        {% set i = 0 %}
                        {% for label, textbox in question.choices %}
                            <td>
                                <input type="{{ type }}"
                                       id="{{ question.id }}:{{ i }}" name="{{ question.id }}"
                                       value="{# FIXME #}">
                            </td>
                            {% set i = i + 1 %}
                        {% endfor %}
                    </tr>
                {% else %}
                    <div>
                        <label for="{{ question.id }}:{{ i }}">{{ question.content }}</label>
                        <input type="text" id="{{ question.id }}:{{ i }}" name="{{ question.id }}"/>
                    </div>
                {% endif %}
            {% endif %}

            {#
            {% if question.subCategory != subcategory %}
                {% set subcategory = question.subCategory %}
                <table>
                    <thead>
                    <tr>
                        <th></th>
                        {% for label, textbox in question.choices %}
                            <th>{{ label }}</th>
                        {% endfor %}
                    </tr>
                    </thead>
                    <tbody>
                    {% for qq in q['questions'] %}
                        <tr>
                            <td>{{ qq['label'] }}</td>
                            {% for choice in q['choices'] %}
                                <td>
                                    <input type="{{ q['input_type'] }}"
                                           id="{{ qq['id'] }}:{{ choice['id'] }}" name="{{ qq['id'] }}"
                                           value="{{ choice['val'] }}">
                                </td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% endif %}
            #}
        {% else %}
            {% include "question_prelude.html.twig" %}
                <div class="question {{ question.id }}">
                    {% if question.type == 'choice' %}
                        {% set type = "radio" %}
                        {% if question.multiple %}
                            {% set type = "checkbox" %}
                        {% endif %}
                        {% set i = 0 %}
                        {% for label, textbox in question.choices %}
                            <div>
                                <input class='{{ type }}' type="{{ type }}" id="{{ question.id }}:{{ i }}"
                                       name="{{ question.id }}" value="{{ i }}">
                                <label class='label label-{{ type }}' for="{{ question.id }}:{{ i }}">{{ label }}</label>
                                {% if textbox %}
                                    <input type="text" id="{{ question.id }}:{{ i }}:text" name="{{ questions.id ~ 'text' }}">
                                {% endif %}
                            </div>
                            {% set i = i + 1 %}
                        {% endfor %}
                    {% elseif question.type == 'text' %}
                        <div>
                            <label for="{{ question.id }}:{{ i }}">{{ question.content }}</label>
                            <input type="text" id="{{ question.id }}:{{ i }}" name="{{ question.id }}"/>
                        </div>
                    {% endif %}
                    {% if question.comment %}
                        <q><i>{{ question.comment|raw }}</i></q>
                    {% endif %}
                </div>
            </div></div></div>
        {% endif %}
    {% endfor %}
    <button type='button' id='save'>Sauvegarder</button>
</form>
<div class='introduction'>
<p>
   Thank you for participating in this survey. Your answer is invaluable to us to constitute the most representative sample of the companies in France.
</p>
</div>
</div>
<footer>
    <p>Done by five students from EPITA: Achraf El Khachchai, Leo Champion, Nathan Quintard, Gonzague De Gineste, Justin Rerolle</p>
</footer>

<script src='/script.js'></script>
</body>

</html>